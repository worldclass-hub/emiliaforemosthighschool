<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emilia Foremost High School - Login Portal</title>
    
    <!-- Django Static Loader -->
    {% load static %}
    
    <!-- Favicon - Emilia Logo -->
    <link rel="icon" type="image/x-icon" href="https://ncctazjcffmpuniwctkz.supabase.co/storage/v1/object/public/user-uploads/EMILIA%20LOGO.png">

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- ==================== ULTIMATE ANTI-OVERSCROLL SYSTEM ==================== -->
    <style>
        /* 1. FIXED POSITION BODY - Prevents any movement beyond boundaries */
        html, body {
            width: 100%;
            height: 100%;
            position: fixed;
            overflow: hidden;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 0;
            padding: 0;
            touch-action: pan-y;
            overscroll-behavior: none;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        /* 2. SINGLE SCROLL CONTAINER - Only this can scroll internally */
        .scroll-container {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            position: relative;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            -webkit-overflow-scrolling: touch;
        }
        
        /* 3. PREVENT TOUCH OVERSCROLL */
        .no-overscroll {
            touch-action: pan-y;
            overscroll-behavior: contain;
        }
        
        /* 4. NO WHITE BORDERS EVER - Content completely contained */
        .main-wrapper {
            width: 100%;
            min-height: 100%;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        /* 5. MOBILE-SPECIFIC FIXES */
        @media (max-width: 768px) {
            .scroll-container {
                -webkit-overflow-scrolling: touch;
                overscroll-behavior: contain;
            }
            
            .main-wrapper {
                padding: 0;
            }
        }
        
        /* 6. SCROLL EDGE DETECTION HELPER */
        .scroll-boundary {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #1e3c72, #2a5298);
            z-index: 9999;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .scroll-boundary.visible {
            opacity: 1;
        }
        
        /* 7. CONTENT CONTAINER - Main content area */
        .content-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100%;
        }
        
        @media (max-width: 768px) {
            .content-container {
                padding: 0;
            }
        }
        
        /* 8. PRESERVED FUNCTIONALITY - Original styles continue below */
        
        /* ==================== ORIGINAL STYLES FROM CODE E ==================== */
        * {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Django Messages Styling */
        .django-messages {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 99999;
            max-width: 400px;
            width: 100%;
        }
        
        .django-message {
            padding: 16px 20px;
            margin-bottom: 10px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            animation: slideInRight 0.3s ease-out;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .message-success {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .message-error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .message-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .message-info {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .message-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .message-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .message-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
            margin-left: 10px;
            transition: all 0.3s ease;
        }
        
        .message-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        /* Original Styles */
        .school-logo {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        }
        
        .login-card {
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
            max-width: 900px;
            width: 100%;
        }
        
        .login-card:hover {
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.15);
        }
        
        .input-field {
            transition: all 0.3s ease;
            border: 2px solid #e2e8f0;
        }
        
        .input-field:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .whatsapp-btn {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            transition: all 0.3s ease;
        }
        
        .whatsapp-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(37, 211, 102, 0.2);
        }
        
        .login-btn {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            transition: all 0.3s ease;
        }
        
        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(30, 60, 114, 0.2);
        }
        
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.7);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            transform: translateY(30px);
            transition: all 0.4s ease;
            max-width: 500px;
            width: 100%;
        }
        
        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }
        
        .success-message {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            border-radius: 12px;
            padding: 20px;
            color: white;
            text-align: center;
            margin-top: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        
        .success-message.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .input-container {
            position: relative;
            margin-top: 10px;
        }
        
        /* ADDED: Password wrapper for desktop large screen */
        .password-wrapper-desktop {
            position: relative;
            width: 100%;
        }
        
        /* ADDED: Password toggle eye icon for desktop */
        .password-toggle-desktop {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #718096;
            cursor: pointer;
            background: none;
            border: none;
            padding: 5px;
            font-size: 14px;
            z-index: 10;
            display: none; /* Hidden by default, will be shown on large screens */
        }
        
        /* Show password toggle on large screens only */
        @media (min-width: 769px) {
            .password-toggle-desktop {
                display: block;
            }
            
            .desktop-password-field {
                padding-right: 45px !important; /* Make room for the eye icon */
            }
        }
        
        /* Mobile Container Styles - Only show on small screens */
        .mobile-container {
            display: none;
            width: 100%;
            max-width: 430px;
            min-height: 100vh;
            background: white;
            margin: 0 auto;
            position: relative;
            overflow-x: hidden;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.2);
        }
        
        .mobile-only {
            display: none;
        }
        
        /* Responsive Breakpoints */
        @media (max-width: 1024px) {
            .login-card {
                max-width: 800px;
            }
            
            .left-section, .right-section {
                padding: 30px !important;
            }
        }
        
        @media (max-width: 768px) {
            .desktop-only {
                display: none !important;
            }
            
            .mobile-container {
                display: block;
                min-height: 100vh;
                height: auto;
                overflow-y: auto;
            }
            
            .mobile-only {
                display: block;
            }
            
            /* Mobile-specific styles */
            .header-gradient {
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
                height: 280px;
                border-radius: 0 0 40px 40px;
                padding: 40px 30px 30px;
                position: relative;
                overflow: hidden;
                width: 100%;
            }
            
            .header-gradient::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.1) 0%, transparent 60%);
            }
            
            .logo-circle {
                width: 80px;
                height: 80px;
                background: rgba(255, 255, 255, 0.95);
                border-radius: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 20px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            }
            
            .school-name {
                text-align: center;
                color: white;
                margin-bottom: 10px;
            }
            
            .school-name h1 {
                font-size: 24px;
                font-weight: 800;
                letter-spacing: -0.5px;
                margin-bottom: 4px;
            }
            
            .school-name p {
                font-size: 16px;
                font-weight: 500;
                opacity: 0.9;
            }
            
            .motto-badge {
                background: rgba(255, 255, 255, 0.15);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 12px 20px;
                display: inline-block;
                margin-top: 20px;
                border: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .login-form-container {
                padding: 30px;
                margin-top: -60px;
                position: relative;
                z-index: 10;
                width: 100%;
                overflow-x: hidden;
                padding-bottom: 50px;
            }
            
            .form-card {
                background: white;
                border-radius: 28px;
                padding: 30px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
                margin-bottom: 25px;
                width: 100%;
                overflow: hidden;
            }
            
            .form-title {
                font-size: 24px;
                font-weight: 700;
                color: #1a202c;
                margin-bottom: 8px;
            }
            
            .form-subtitle {
                color: #718096;
                font-size: 15px;
                margin-bottom: 30px;
            }
            
            .input-group {
                margin-bottom: 24px;
                width: 100%;
            }
            
            .input-label {
                display: block;
                font-size: 14px;
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 10px;
            }
            
            .input-field {
                width: 100%;
                padding: 18px 20px;
                border: 2px solid #e2e8f0;
                border-radius: 16px;
                font-size: 16px;
                transition: all 0.3s;
                background: #f8fafc;
            }
            
            .input-field:focus {
                outline: none;
                border-color: #3b82f6;
                background: white;
                box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            }
            
            .password-toggle {
                position: absolute;
                right: 20px;
                top: 50%;
                transform: translateY(-50%);
                color: #718096;
                cursor: pointer;
            }
            
            .login-btn {
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
                color: white;
                width: 100%;
                padding: 20px;
                border-radius: 16px;
                font-size: 17px;
                font-weight: 700;
                border: none;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                transition: all 0.3s;
                box-shadow: 0 8px 25px rgba(30, 60, 114, 0.25);
            }
            
            .whatsapp-btn {
                background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
                color: white;
                width: 100%;
                padding: 20px;
                border-radius: 16px;
                font-size: 17px;
                font-weight: 700;
                border: none;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                transition: all 0.3s;
                box-shadow: 0 8px 25px rgba(37, 211, 102, 0.25);
                margin-top: 20px;
            }
            
            .divider {
                display: flex;
                align-items: center;
                text-align: center;
                margin: 30px 0;
                color: #a0aec0;
                font-size: 14px;
                width: 100%;
            }
            
            .divider::before, .divider::after {
                content: '';
                flex: 1;
                border-bottom: 1px solid #e2e8f0;
            }
            
            .divider span {
                padding: 0 15px;
            }
            
            /* UPDATED: Quick access buttons layout - FIXED FOR IPHONE 11 */
            .quick-access {
                display: flex;
                flex-direction: row;
                gap: 15px;
                margin-top: 25px;
                width: 100%;
                justify-content: space-between;
            }
            
            .access-card {
                background: #f8fafc;
                border-radius: 16px;
                padding: 18px 12px;
                text-align: center;
                border: 2px solid #e2e8f0;
                transition: all 0.3s;
                min-height: 95px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                flex: 1;
                min-width: 0;
                box-sizing: border-box;
                width: 100%;
                cursor: pointer;
            }
            
            .access-card:active {
                background: #edf2f7;
                transform: scale(0.98);
            }
            
            .access-icon {
                width: 44px;
                height: 44px;
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 10px;
                font-size: 20px;
                flex-shrink: 0;
            }
            
            .whatsapp-icon {
                background: rgba(37, 211, 102, 0.1);
                color: #25D366;
            }
            
            .contact-icon {
                background: rgba(59, 130, 246, 0.1);
                color: #3b82f6;
            }
            
            .access-card p {
                font-weight: 600;
                color: #2d3748;
                font-size: 14px;
                line-height: 1.3;
                margin: 0;
                padding: 0 2px;
                word-wrap: break-word;
                overflow-wrap: break-word;
                width: 100%;
                text-align: center;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            
            /* Mobile Modal Styles */
            .mobile-modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.85);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                padding: 20px;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                overflow: hidden;
            }
            
            .mobile-modal-overlay.active {
                opacity: 1;
                visibility: visible;
            }
            
            .mobile-modal {
                background: white;
                border-radius: 28px;
                width: 100%;
                max-width: 400px;
                padding: 0;
                overflow: hidden;
                transform: translateY(30px);
                transition: transform 0.4s ease;
                max-height: 90vh;
                overflow-y: auto;
            }
            
            .mobile-modal-overlay.active .mobile-modal {
                transform: translateY(0);
            }
            
            .modal-header {
                background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
                padding: 25px;
                color: white;
                display: flex;
                align-items: center;
                gap: 15px;
            }
            
            .modal-header-icon {
                width: 60px;
                height: 60px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 28px;
            }
            
            .modal-header-text h3 {
                font-size: 22px;
                font-weight: 800;
                margin-bottom: 5px;
            }
            
            .modal-header-text p {
                opacity: 0.9;
                font-size: 14px;
            }
            
            .modal-body {
                padding: 30px;
            }
            
            .modal-input-group {
                margin-bottom: 24px;
            }
            
            .modal-label {
                display: block;
                font-size: 15px;
                font-weight: 600;
                color: #4a5568;
                margin-bottom: 10px;
            }
            
            .modal-input {
                width: 100%;
                padding: 18px 20px;
                border: 2px solid #e2e8f0;
                border-radius: 16px;
                font-size: 16px;
                transition: all 0.3s;
                background: #f8fafc;
            }
            
            .modal-input:focus {
                outline: none;
                border-color: #25D366;
                background: white;
                box-shadow: 0 0 0 4px rgba(37, 211, 102, 0.1);
            }
            
            .modal-actions {
                display: flex;
                gap: 15px;
                margin-top: 30px;
            }
            
            .modal-submit {
                flex: 1;
                background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
                color: white;
                border: none;
                padding: 18px;
                border-radius: 16px;
                font-weight: 700;
                font-size: 16px;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }
            
            .modal-cancel {
                flex: 1;
                background: #f1f5f9;
                color: #64748b;
                border: none;
                padding: 18px;
                border-radius: 16px;
                font-weight: 600;
                font-size: 16px;
            }
            
            .success-toast {
                position: fixed;
                bottom: 30px;
                left: 20px;
                right: 20px;
                background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
                color: white;
                padding: 22px;
                border-radius: 20px;
                display: flex;
                align-items: center;
                gap: 15px;
                box-shadow: 0 15px 40px rgba(37, 211, 102, 0.3);
                z-index: 100;
                transform: translateY(100px);
                opacity: 0;
                transition: all 0.5s ease;
            }
            
            .success-toast.active {
                transform: translateY(0);
                opacity: 1;
            }
            
            .toast-icon {
                width: 50px;
                height: 50px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 14px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 24px;
            }
            
            .toast-text h4 {
                font-weight: 700;
                font-size: 17px;
                margin-bottom: 4px;
            }
            
            .toast-text p {
                font-size: 14px;
                opacity: 0.9;
            }
            
            .footer {
                text-align: center;
                padding: 25px 30px;
                color: #718096;
                font-size: 13px;
                border-top: 1px solid #f1f5f9;
                width: 100%;
                background: white;
            }
            
            .footer-links {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-top: 15px;
            }
            
            .footer-links a {
                color: #4a5568;
                text-decoration: none;
                font-weight: 500;
                font-size: 14px;
            }
            
            /* Password toggle */
            .password-wrapper {
                position: relative;
                width: 100%;
            }
            
            /* Contact Admin Modal Specific Styles */
            .contact-modal .modal-header {
                background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            }
            
            .contact-modal .modal-submit {
                background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            }
            
            .contact-modal .modal-input:focus {
                border-color: #3b82f6;
                box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            }
        }
        
        /* iPhone 11 specific adjustments (414px width) */
        @media (max-width: 414px) {
            .quick-access {
                gap: 12px;
            }
            
            .access-card {
                padding: 16px 10px;
                min-height: 90px;
            }
            
            .access-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
                margin-bottom: 8px;
            }
            
            .access-card p {
                font-size: 13px;
                line-height: 1.2;
            }
        }
        
        @media (max-width: 380px) {
            .header-gradient {
                height: 260px;
                padding: 30px 25px 25px;
            }
            
            .login-form-container {
                padding: 25px;
            }
            
            .form-card {
                padding: 25px;
            }
            
            .quick-access {
                gap: 10px;
            }
            
            .access-card {
                padding: 14px 8px;
                min-height: 85px;
            }
            
            .access-icon {
                width: 36px;
                height: 36px;
                font-size: 16px;
                margin-bottom: 6px;
            }
            
            .access-card p {
                font-size: 12px;
            }
            
            .modal-actions {
                flex-direction: column;
            }
        }
        
        @media (max-width: 320px) {
            .access-card p {
                font-size: 11px;
            }
            
            .access-icon {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
            
            .access-card {
                padding: 12px 6px;
            }
        }
        
        /* Middle screen (tablet) adjustments */
        @media (min-width: 769px) and (max-width: 1024px) {
            .login-card {
                max-width: 700px;
                margin: 20px auto;
            }
            
            .left-section, .right-section {
                padding: 25px !important;
            }
            
            .left-section h1 {
                font-size: 22px !important;
            }
            
            .left-section p {
                font-size: 14px !important;
            }
        }
        
        /* Small laptop screens */
        @media (max-height: 800px) and (min-width: 1025px) {
            .login-card {
                max-height: 95vh;
                overflow-y: auto;
            }
            
            .left-section, .right-section {
                padding: 25px !important;
            }
        }
        
        /* FIX: Prevent body scroll when modal is open */
        body.modal-open {
            overflow: hidden;
        }
        
        /* Prevent overscroll on mobile */
        @media (max-width: 768px) {
            body {
                overscroll-behavior-y: contain;
            }
            
            .django-messages {
                top: 10px;
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }
    </style>
</head>
<body class="no-overscroll">
    <!-- ==================== ULTIMATE SCROLL RESTRICTION SYSTEM ==================== -->
    <!-- Scroll Boundary Indicator -->
    <div id="scrollBoundary" class="scroll-boundary"></div>
    
    <!-- 2. SINGLE SCROLL CONTAINER -->
    <div class="scroll-container" id="scrollContainer">
        <div class="main-wrapper">
            <div class="content-container">
                <!-- Django Messages Display -->
                {% if messages %}
                <div class="django-messages">
                    {% for message in messages %}
                    <div class="django-message message-{{ message.tags }}">
                        <div class="message-content">
                            <div class="message-icon">
                                {% if message.tags == 'success' %}
                                <i class="fas fa-check-circle"></i>
                                {% elif message.tags == 'error' %}
                                <i class="fas fa-exclamation-circle"></i>
                                {% elif message.tags == 'warning' %}
                                <i class="fas fa-exclamation-triangle"></i>
                                {% else %}
                                <i class="fas fa-info-circle"></i>
                                {% endif %}
                            </div>
                            <div class="message-text">
                                {{ message }}
                            </div>
                        </div>
                        <button class="message-close" onclick="this.parentElement.style.animation='slideOutRight 0.3s ease-out forwards'; setTimeout(() => this.parentElement.remove(), 300)">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                <!-- Desktop/Large Screen Design -->
                <div class="desktop-only">
                    <!-- Login Card - Reduced size -->
                    <div class="login-card bg-white flex flex-col lg:flex-row">
                        <!-- Left Section -->
                        <div class="left-section school-logo text-white p-8 lg:p-10 flex flex-col justify-center lg:w-2/5">
                            <div class="mb-6">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-white flex items-center justify-center mr-4">
                                        <i class="fas fa-graduation-cap text-2xl" style="color: #1e3c72;"></i>
                                    </div>
                                    <div>
                                        <h1 class="text-2xl font-bold">EMILIA FOREMOST</h1>
                                        <p class="text-lg font-medium">HIGH SCHOOL</p>
                                    </div>
                                </div>
                                <p class="text-sm opacity-90">Excellence in Education Since 2007</p>
                            </div>
                            
                            <div class="mt-6">
                                <h3 class="text-lg font-bold mb-3">School Motto</h3>
                                <p class="italic text-sm">"Knowledge, Character, Excellence"</p>
                            </div>
                            
                            <div class="mt-8">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-white flex items-center justify-center mr-3">
                                        <i class="fas fa-award" style="color: #1e3c72;"></i>
                                    </div>
                                    <div>
                                        <p class="font-bold text-sm">Top 1% National Ranking</p>
                                    </div>
                                </div>
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-white flex items-center justify-center mr-3">
                                        <i class="fas fa-users" style="color: #1e3c72;"></i>
                                    </div>
                                    <div>
                                        <p class="font-bold text-sm">Certified & Experienced Faculty</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-8 h-8 rounded-full bg-white flex items-center justify-center mr-3">
                                        <i class="fas fa-shield-alt" style="color: #1e3c72;"></i>
                                    </div>
                                    <div>
                                        <p class="font-bold text-sm">Secure Learning Environment</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Right Section - Login Form -->
                        <div class="right-section p-8 lg:p-10 lg:w-3/5">
                            <div class="mb-6">
                                <h2 class="text-2xl font-bold text-gray-800 mb-2">Secure Login Portal</h2>
                                <p class="text-gray-600 text-sm">Access student records, examination, and school resources</p>
                            </div>
                            
                            <!-- Django Login Form -->
                            <form id="loginForm" class="mb-4" method="POST" action="{% url 'login_page' %}">
                                {% csrf_token %}
                                
                                <div class="mb-4">
                                    <input type="text" id="username" name="username" class="input-field w-full p-3 rounded-xl focus:outline-none text-sm" placeholder="Username / Email (e.g., student.name@emilia.edu)" required>
                                </div>
                                
                                <div class="mb-6">
                                    <!-- ADDED: Password wrapper with eye icon for desktop -->
                                    <div class="password-wrapper-desktop">
                                        <input type="password" id="password" name="password" class="input-field w-full p-3 rounded-xl focus:outline-none text-sm desktop-password-field" placeholder="Password" required>
                                        <!-- ADDED: Eye icon for password toggle -->
                                        <button type="button" id="desktopPasswordToggle" class="password-toggle-desktop">
                                            <i class="far fa-eye"></i>
                                        </button>
                                    </div>
                                    <div class="flex justify-end mt-2">
                                        <a href="#" class="text-blue-600 hover:text-blue-800 text-xs font-medium">Forgot Password?</a>
                                    </div>
                                </div>
                                
                                <button type="submit" class="login-btn text-white font-bold py-3 px-6 rounded-xl w-full mb-4 focus:outline-none text-sm">
                                    <i class="fas fa-sign-in-alt mr-2"></i> Login to Portal
                                </button>
                            </form>
                            
                            <div class="text-center text-gray-600 mb-4 text-sm">
                                <div class="flex items-center justify-center mb-3">
                                    <div class="h-px bg-gray-300 flex-1"></div>
                                    <span class="px-3 text-xs">OR</span>
                                    <div class="h-px bg-gray-300 flex-1"></div>
                                </div>
                                <p class="mb-1">Don't have an account yet?</p>
                                <p class="font-medium">Request access via WhatsApp</p>
                            </div>
                            
                            <button id="whatsappBtn" class="whatsapp-btn text-white font-bold py-3 px-6 rounded-xl w-full mb-4 focus:outline-none text-sm">
                                <i class="fab fa-whatsapp mr-2 text-lg"></i> Request Access via WhatsApp
                            </button>
                            
                            <div class="text-center text-gray-500 text-xs">
                                <p>By accessing the portal, you agree to our <a href="#" class="text-blue-600 hover:text-blue-800 font-medium">Terms of Service</a> and <a href="#" class="text-blue-600 hover:text-blue-800 font-medium">Privacy Policy</a></p>
                            </div>
                            
                            <!-- Success message (hidden by default) -->
                            <div id="successMessage" class="success-message">
                                <i class="fab fa-whatsapp text-2xl mb-2"></i>
                                <h3 class="text-lg font-bold mb-2">Request Sent Successfully!</h3>
                                <p class="text-sm">Your access request has been sent via WhatsApp. The school administration will contact you within 24 hours.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- If user is already logged in (for testing), show logout option -->
                    {% if user.is_authenticated %}
                    <div class="text-center mt-4 bg-white p-4 rounded-lg shadow-md max-w-md mx-auto">
                        <p class="text-gray-600">You are logged in as <span class="font-bold">{{ user.username }}</span></p>
                        <a href="{% url 'logout' %}" class="text-red-600 hover:text-red-800 font-medium mt-2 inline-block">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </a>
                    </div>
                    {% endif %}
                    
                    <!-- WhatsApp Request Modal -->
                    <div id="whatsappModal" class="modal-overlay">
                        <div class="modal-content">
                            <div class="bg-white rounded-2xl p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                            <i class="fab fa-whatsapp text-xl text-green-600"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-xl font-bold text-gray-800">Request Access</h3>
                                            <p class="text-gray-600 text-sm">via WhatsApp</p>
                                        </div>
                                    </div>
                                    <button id="closeModal" class="text-gray-500 hover:text-gray-800 text-xl">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <p class="text-gray-600 mb-6 text-sm">Please provide the following details to request access to the school portal. The administration will contact you via WhatsApp.</p>
                                
                                <form id="whatsappForm">
                                    <div class="mb-4">
                                        <input type="text" id="studentName" class="input-field w-full p-3 rounded-xl focus:outline-none text-sm" placeholder="Student's Full Name">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <input type="text" id="studentClass" class="input-field w-full p-3 rounded-xl focus:outline-none text-sm" placeholder="Class / Grade (e.g., Grade 10, Class B)">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <input type="text" id="parentName" class="input-field w-full p-3 rounded-xl focus:outline-none text-sm" placeholder="Parent/Guardian Name">
                                    </div>
                                    
                                    <div class="mb-6">
                                        <input type="tel" id="whatsappNumber" class="input-field w-full p-3 rounded-xl focus:outline-none text-sm" placeholder="WhatsApp Number (e.g., +1 (555) 123-4567)">
                                        <p class="text-gray-500 text-xs mt-1">Enter WhatsApp number with country code. All numbers accepted.</p>
                                    </div>
                                    
                                    <div class="flex flex-col sm:flex-row gap-3">
                                        <button type="submit" class="whatsapp-btn text-white font-bold py-3 px-6 rounded-xl flex-1 focus:outline-none text-sm">
                                            <i class="fab fa-whatsapp mr-2"></i> Send Request via WhatsApp
                                        </button>
                                        <button type="button" id="cancelBtn" class="bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-xl hover:bg-gray-300 transition duration-300 focus:outline-none text-sm">
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Mobile/Small Screen Design -->
                <div class="mobile-container mobile-only">
                    <!-- Header with School Info -->
                    <div class="header-gradient">
                        <div class="logo-circle">
                            <i class="fas fa-graduation-cap text-3xl" style="color: #1e3c72;"></i>
                        </div>
                        
                        <div class="school-name">
                            <h1>EMILIA FOREMOST</h1>
                            <p>HIGH SCHOOL</p>
                        </div>
                        
                        <div class="text-center mt-6">
                            <div class="motto-badge">
                                <p class="text-white font-semibold">"Knowledge, Character, Excellence"</p>
                            </div>
                            <p class="text-white mt-4 opacity-90 text-sm">Established 2007 • Premier Education</p>
                        </div>
                    </div>
                    
                    <!-- Login Form Container -->
                    <div class="login-form-container">
                        <div class="form-card">
                            <h2 class="form-title">Secure Login</h2>
                            <p class="form-subtitle">Access student portal, exams & resources</p>
                            
                            <!-- Django Mobile Login Form -->
                            <form id="mobileLoginForm">
                                {% csrf_token %}
                                <div class="input-group">
                                    <label class="input-label" for="mobileUsername">Student ID / Email</label>
                                    <input type="text" id="mobileUsername" name="username" class="input-field" placeholder="student.name@emilia.edu" required>
                                </div>
                                
                                <div class="input-group">
                                    <label class="input-label" for="mobilePassword">Password</label>
                                    <div class="password-wrapper">
                                        <input type="password" id="mobilePassword" name="password" class="input-field" placeholder="Enter your password" required>
                                        <span class="password-toggle" id="passwordToggle">
                                            <i class="far fa-eye"></i>
                                        </span>
                                    </div>
                                    <div class="flex justify-end mt-3">
                                        <a href="#" class="text-blue-600 font-medium text-sm">Forgot Password?</a>
                                    </div>
                                </div>
                                
                                <button type="submit" class="login-btn" id="mobileLoginBtn">
                                    <i class="fas fa-sign-in-alt"></i>
                                    Login to Portal
                                </button>
                            </form>
                            
                            <div class="divider">
                                <span>No account? Request access</span>
                            </div>
                            
                            <button class="whatsapp-btn" id="mobileWhatsappBtn">
                                <i class="fab fa-whatsapp"></i>
                                Request via WhatsApp
                            </button>
                            
                            <!-- UPDATED: Quick access buttons facing each other - FIXED FOR IPHONE 11 -->
                            <div class="quick-access">
                                <div class="access-card" id="whatsappQuickBtn">
                                    <div class="access-icon whatsapp-icon">
                                        <i class="fab fa-whatsapp"></i>
                                    </div>
                                    <p>WhatsApp Request</p>
                                </div>
                                
                                <div class="access-card" id="contactBtn">
                                    <div class="access-icon contact-icon">
                                        <i class="fas fa-phone-alt"></i>
                                    </div>
                                    <p>Call Admin Directly</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center text-sm text-gray-500 mt-8">
                            <p>By accessing, you agree to our <a href="#" class="text-blue-600 font-medium">Terms</a> & <a href="#" class="text-blue-600 font-medium">Privacy</a></p>
                        </div>
                    </div>
                    
                    <!-- Footer -->
                    <div class="footer">
                        <p>© 2026 Emilia Foremost High School. All rights reserved.</p>
                        <div class="footer-links">
                            <a href="#">Website</a>
                            <a href="#">Calendar</a>
                            <a href="#">Contact</a>
                        </div>
                    </div>
                </div>
                
                <!-- WhatsApp Modal for Mobile -->
                <div class="mobile-modal-overlay mobile-only" id="mobileModal">
                    <div class="mobile-modal">
                        <div class="modal-header">
                            <div class="modal-header-icon">
                                <i class="fab fa-whatsapp"></i>
                            </div>
                            <div class="modal-header-text">
                                <h3>Request Portal Access</h3>
                                <p>Via WhatsApp - Any country accepted</p>
                            </div>
                        </div>
                        
                        <div class="modal-body">
                            <p class="text-gray-600 mb-6">Provide student details. Administration will contact you via WhatsApp within 24 hours.</p>
                            
                            <form id="mobileWhatsappForm">
                                <div class="modal-input-group">
                                    <label class="modal-label" for="modalStudentName">Student's Full Name</label>
                                    <input type="text" id="modalStudentName" class="modal-input" placeholder="John Smith">
                                </div>
                                
                                <div class="modal-input-group">
                                    <label class="modal-label" for="modalStudentClass">Class / Grade</label>
                                    <input type="text" id="modalStudentClass" class="modal-input" placeholder="Grade 10, Class B">
                                </div>
                                
                                <div class="modal-input-group">
                                    <label class="modal-label" for="modalParentName">Parent/Guardian Name</label>
                                    <input type="text" id="modalParentName" class="modal-input" placeholder="Parent/Guardian Name">
                                </div>
                                
                                <div class="modal-input-group">
                                    <label class="modal-label" for="modalWhatsappNumber">WhatsApp Number</label>
                                    <input type="tel" id="modalWhatsappNumber" class="modal-input" placeholder="+1 (555) 123-4567">
                                    <p class="text-gray-500 text-sm mt-2">Any country code accepted. We'll contact you here.</p>
                                </div>
                                
                                <div class="modal-actions">
                                    <button type="submit" class="modal-submit">
                                        <i class="fab fa-whatsapp"></i>
                                        Send Request
                                    </button>
                                    <button type="button" class="modal-cancel" id="mobileModalCancel">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Success Toast for Mobile -->
                <div class="success-toast mobile-only" id="mobileSuccessToast">
                    <div class="toast-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <div class="toast-text">
                        <h4 id="toastTitle">Request Sent Successfully!</h4>
                        <p id="toastMessage">We'll contact you via WhatsApp within 24 hours.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== ENHANCED SCROLL MANAGEMENT ====================
        
        function setupScrollManagement() {
            const scrollContainer = document.getElementById('scrollContainer');
            
            // 1. FIXED POSITION BODY already set in CSS
            
            // 2. SINGLE SCROLL CONTAINER management
            scrollContainer.style.overflowY = 'auto';
            scrollContainer.style.overflowX = 'hidden';
            
            // 3. PREVENT TOUCH OVERSCROLL
            if ('ontouchstart' in window) {
                // iOS specific fixes
                scrollContainer.style.WebkitOverflowScrolling = 'touch';
                
                // Prevent pull-to-refresh
                document.addEventListener('touchmove', function(e) {
                    if (scrollContainer.scrollTop <= 0) {
                        e.preventDefault();
                    }
                }, { passive: false });
                
                // Prevent rubber band effect
                document.body.addEventListener('touchstart', function() {
                    if (scrollContainer.scrollTop === 0) {
                        scrollContainer.scrollTop = 1;
                    }
                    if (scrollContainer.scrollHeight - scrollContainer.scrollTop === scrollContainer.clientHeight) {
                        scrollContainer.scrollTop = scrollContainer.scrollTop - 1;
                    }
                });
            }
            
            // 6. SCROLL EDGE DETECTION
            scrollContainer.addEventListener('scroll', function() {
                // Show boundary indicator when near bottom
                const distanceFromBottom = this.scrollHeight - (this.scrollTop + this.clientHeight);
                const boundary = document.getElementById('scrollBoundary');
                
                if (distanceFromBottom <= 50 && distanceFromBottom > 0) {
                    boundary.classList.add('visible');
                } else {
                    boundary.classList.remove('visible');
                }
                
                // Prevent overscroll at top
                if (this.scrollTop <= 0) {
                    this.scrollTop = 1;
                }
                
                // Prevent overscroll at bottom
                if (this.scrollTop + this.clientHeight >= this.scrollHeight) {
                    this.scrollTop = this.scrollHeight - this.clientHeight - 1;
                }
            });
            
            // 7. PRESERVED FUNCTIONALITY - All original functionality preserved
        }

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Setup scroll management FIRST
            setupScrollManagement();
            
            // Auto-remove Django messages after 5 seconds
            setTimeout(() => {
                const messages = document.querySelectorAll('.django-message');
                messages.forEach(message => {
                    message.style.animation = 'slideOutRight 0.3s ease-out forwards';
                    setTimeout(() => message.remove(), 300);
                });
            }, 5000);
        });
        
        // ==================== DJANGO INTEGRATION ====================
        
        // Function to show toast message
        function showToast(title, message) {
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            
            if (toastTitle) toastTitle.textContent = title;
            if (toastMessage) toastMessage.textContent = message;
            
            if (mobileSuccessToast) {
                mobileSuccessToast.classList.add('active');
                
                // Hide toast after 5 seconds
                setTimeout(() => {
                    if (mobileSuccessToast) mobileSuccessToast.classList.remove('active');
                }, 5000);
            }
        }
        
        // Function to show Django-style message
        function showDjangoMessage(message, type = 'success') {
            const messagesContainer = document.querySelector('.django-messages');
            if (!messagesContainer) {
                // Create messages container if it doesn't exist
                const newContainer = document.createElement('div');
                newContainer.className = 'django-messages';
                document.body.appendChild(newContainer);
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `django-message message-${type}`;
            
            let icon = 'fas fa-info-circle';
            if (type === 'success') icon = 'fas fa-check-circle';
            else if (type === 'error') icon = 'fas fa-exclamation-circle';
            else if (type === 'warning') icon = 'fas fa-exclamation-triangle';
            
            messageDiv.innerHTML = `
                <div class="message-content">
                    <div class="message-icon">
                        <i class="${icon}"></i>
                    </div>
                    <div class="message-text">
                        ${message}
                    </div>
                </div>
                <button class="message-close" onclick="this.parentElement.style.animation='slideOutRight 0.3s ease-out forwards'; setTimeout(() => this.parentElement.remove(), 300)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            const container = document.querySelector('.django-messages');
            container.appendChild(messageDiv);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                messageDiv.style.animation = 'slideOutRight 0.3s ease-out forwards';
                setTimeout(() => messageDiv.remove(), 300);
            }, 5000);
        }
        
        // ==================== MOBILE LOGIN WITH DJANGO ====================
        const mobileLoginForm = document.getElementById('mobileLoginForm');
        if (mobileLoginForm) {
            mobileLoginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const username = document.getElementById('mobileUsername').value;
                const password = document.getElementById('mobilePassword').value;
                const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                
                if (!username || !password) {
                    showToast('Error', 'Please enter both username and password');
                    return;
                }
                
                const loginBtn = document.getElementById('mobileLoginBtn');
                const originalText = loginBtn.innerHTML;
                const originalDisabled = loginBtn.disabled;
                
                loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                loginBtn.disabled = true;
                
                try {
                    const response = await fetch('/login/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Requested-With': 'XMLHttpRequest',
                            'X-CSRFToken': csrfToken
                        },
                        body: JSON.stringify({
                            username: username,
                            password: password
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        showToast('Login Successful!', data.message);
                        // Redirect to general_page after 2 seconds
                        setTimeout(() => {
                            window.location.href = data.redirect_url || '/general_page/';
                        }, 2000);
                    } else {
                        showToast('Login Failed', data.message);
                        loginBtn.innerHTML = originalText;
                        loginBtn.disabled = originalDisabled;
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    showToast('Error', 'An error occurred during login');
                    loginBtn.innerHTML = originalText;
                    loginBtn.disabled = originalDisabled;
                }
            });
        }
        
        // ==================== ORIGINAL FUNCTIONALITY ====================
        
        // Desktop/Large Screen JavaScript
        const whatsappBtn = document.getElementById('whatsappBtn');
        const whatsappModal = document.getElementById('whatsappModal');
        const closeModal = document.getElementById('closeModal');
        const cancelBtn = document.getElementById('cancelBtn');
        const whatsappForm = document.getElementById('whatsappForm');
        const loginForm = document.getElementById('loginForm');
        const successMessage = document.getElementById('successMessage');
        const scrollContainer = document.getElementById('scrollContainer');
        
        // ADDED: Desktop password toggle functionality
        const desktopPasswordToggle = document.getElementById('desktopPasswordToggle');
        const desktopPasswordField = document.getElementById('password');
        
        if (desktopPasswordToggle && desktopPasswordField) {
            desktopPasswordToggle.addEventListener('click', () => {
                const type = desktopPasswordField.getAttribute('type') === 'password' ? 'text' : 'password';
                desktopPasswordField.setAttribute('type', type);
                
                // Toggle eye icon
                const eyeIcon = desktopPasswordToggle.querySelector('i');
                if (type === 'password') {
                    eyeIcon.className = 'far fa-eye';
                } else {
                    eyeIcon.className = 'far fa-eye-slash';
                }
            });
        }
        
        // Show modal when WhatsApp button is clicked
        if (whatsappBtn) {
            whatsappBtn.addEventListener('click', () => {
                whatsappModal.classList.add('active');
                // Disable main scroll container scroll when modal is open
                scrollContainer.style.overflow = 'hidden';
                document.body.classList.add('modal-open');
            });
        }
        
        // Close modal functions
        const closeModalFunc = () => {
            if (whatsappModal) whatsappModal.classList.remove('active');
            // Re-enable main scroll container scroll when modal is closed
            scrollContainer.style.overflow = 'auto';
            document.body.classList.remove('modal-open');
        };
        
        if (closeModal) closeModal.addEventListener('click', closeModalFunc);
        if (cancelBtn) cancelBtn.addEventListener('click', closeModalFunc);
        
        // Close modal when clicking outside
        if (whatsappModal) {
            whatsappModal.addEventListener('click', (e) => {
                if (e.target === whatsappModal) {
                    closeModalFunc();
                }
            });
        }
        
        // Handle WhatsApp form submission (Desktop)
        if (whatsappForm) {
            whatsappForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Get form values
                const studentName = document.getElementById('studentName').value;
                const studentClass = document.getElementById('studentClass').value;
                const parentName = document.getElementById('parentName').value;
                const whatsappNumber = document.getElementById('whatsappNumber').value;
                
                // Validate form
                if (!studentName || !studentClass || !parentName || !whatsappNumber) {
                    showDjangoMessage('Please fill in all fields', 'error');
                    return;
                }
                
                // Create WhatsApp message
                const message = `New Portal Access Request:%0A%0AStudent: ${studentName}%0AClass: ${studentClass}%0AParent: ${parentName}%0AWhatsApp: ${whatsappNumber}`;
                
                // Open WhatsApp with pre-filled message
                const adminNumber = "2349057147497"; // Nigerian number format for WhatsApp
                const whatsappURL = `https://wa.me/${adminNumber}?text=${message}`;
                
                // Open WhatsApp in new tab
                window.open(whatsappURL, '_blank');
                
                // Show success message
                closeModalFunc();
                if (successMessage) successMessage.classList.add('active');
                
                // Reset form
                whatsappForm.reset();
                
                // Hide success message after 5 seconds
                setTimeout(() => {
                    if (successMessage) successMessage.classList.remove('active');
                }, 5000);
            });
        }
        
        // Handle desktop login form submission (traditional POST)
        if (loginForm) {
            loginForm.addEventListener('submit', (e) => {
                // Let Django handle the form submission
                // The form will be submitted to your login_view
                // which will handle both AJAX and traditional POST
                const username = document.getElementById('username').value;
                const password = desktopPasswordField ? desktopPasswordField.value : '';
                
                if (!username || !password) {
                    e.preventDefault();
                    showDjangoMessage('Please enter both username and password', 'error');
                    return;
                }
                
                // Show loading state
                const loginBtn = loginForm.querySelector('button[type="submit"]');
                const originalText = loginBtn.innerHTML;
                
                loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Logging in...';
                loginBtn.disabled = true;
            });
        }
        
        // Mobile Screen JavaScript
        const mobileWhatsappBtn = document.getElementById('mobileWhatsappBtn');
        const whatsappQuickBtn = document.getElementById('whatsappQuickBtn');
        const mobileModal = document.getElementById('mobileModal');
        const mobileModalCancel = document.getElementById('mobileModalCancel');
        const mobileWhatsappForm = document.getElementById('mobileWhatsappForm');
        const mobileSuccessToast = document.getElementById('mobileSuccessToast');
        const passwordToggle = document.getElementById('passwordToggle');
        const mobilePassword = document.getElementById('mobilePassword');
        const contactBtn = document.getElementById('contactBtn');
        
        // Show WhatsApp modal when WhatsApp button is clicked (mobile)
        const showWhatsappModal = () => {
            if (mobileModal) {
                mobileModal.classList.add('active');
                // Disable scroll when modal is open
                document.getElementById('scrollContainer').style.overflow = 'hidden';
                document.body.classList.add('modal-open');
            }
        };
        
        // FIXED: Contact button now calls the number directly
        const callAdminDirectly = () => {
            const phoneNumber = "08022854677"; // The number to call
            // Format for tel link
            const telLink = `tel:${phoneNumber}`;
            
            // Show confirmation dialog
            if (confirm(`Call school administration at ${phoneNumber}?`)) {
                // Create and trigger a temporary link for calling
                const link = document.createElement('a');
                link.href = telLink;
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Show toast notification
                showToast('Calling Admin...', `Dialing ${phoneNumber}`);
            }
        };
        
        if (mobileWhatsappBtn) mobileWhatsappBtn.addEventListener('click', showWhatsappModal);
        if (whatsappQuickBtn) whatsappQuickBtn.addEventListener('click', showWhatsappModal);
        
        // Contact button action - NOW CALLS DIRECTLY
        if (contactBtn) {
            contactBtn.addEventListener('click', callAdminDirectly);
        }
        
        // Close modal functions (mobile)
        const closeMobileModal = (modalType = 'whatsapp') => {
            if (modalType === 'whatsapp' && mobileModal) {
                mobileModal.classList.remove('active');
            }
            // Re-enable scroll when modal is closed
            document.getElementById('scrollContainer').style.overflow = 'auto';
            document.body.classList.remove('modal-open');
        };
        
        if (mobileModalCancel) mobileModalCancel.addEventListener('click', () => closeMobileModal('whatsapp'));
        
        // Close modal when clicking outside (mobile)
        if (mobileModal) {
            mobileModal.addEventListener('click', (e) => {
                if (e.target === mobileModal) {
                    closeMobileModal('whatsapp');
                }
            });
        }
        
        // Toggle password visibility (mobile)
        if (passwordToggle && mobilePassword) {
            passwordToggle.addEventListener('click', () => {
                const type = mobilePassword.getAttribute('type') === 'password' ? 'text' : 'password';
                mobilePassword.setAttribute('type', type);
                passwordToggle.innerHTML = type === 'password' ? '<i class="far fa-eye"></i>' : '<i class="far fa-eye-slash"></i>';
            });
        }
        
        // Handle WhatsApp form submission (mobile)
        if (mobileWhatsappForm) {
            mobileWhatsappForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Get form values
                const studentName = document.getElementById('modalStudentName').value;
                const studentClass = document.getElementById('modalStudentClass').value;
                const parentName = document.getElementById('modalParentName').value;
                const whatsappNumber = document.getElementById('modalWhatsappNumber').value;
                
                // Validate form
                if (!studentName || !studentClass || !parentName || !whatsappNumber) {
                    showToast('Error', 'Please fill in all fields');
                    return;
                }
                
                // Create WhatsApp message
                const message = `New Portal Access Request:%0A%0AStudent: ${encodeURIComponent(studentName)}%0AClass: ${encodeURIComponent(studentClass)}%0AParent: ${encodeURIComponent(parentName)}%0AWhatsApp: ${encodeURIComponent(whatsappNumber)}`;
                
                // Open WhatsApp with pre-filled message
                const adminNumber = "2349057147497"; // Nigerian number format for WhatsApp
                const whatsappURL = `https://wa.me/${adminNumber}?text=${message}`;
                
                // Open WhatsApp in new tab
                window.open(whatsappURL, '_blank');
                
                // Show success toast
                closeMobileModal('whatsapp');
                showToast('Request Sent Successfully!', 'We\'ll contact you via WhatsApp within 24 hours.');
                
                // Reset form
                mobileWhatsappForm.reset();
            });
        }
        
        // Add interactive effects for mobile
        const accessCards = document.querySelectorAll('.access-card');
        accessCards.forEach(card => {
            card.addEventListener('touchstart', () => {
                card.style.transform = 'scale(0.98)';
            });
            
            card.addEventListener('touchend', () => {
                card.style.transform = 'scale(1)';
            });
        });
        
        // Initialize demo data
        window.addEventListener('DOMContentLoaded', () => {
            // Pre-fill the desktop login form with demo credentials
            const desktopUsername = document.getElementById('username');
            const desktopPassword = document.getElementById('password');
            
            if (desktopUsername) desktopUsername.value = "student.name@emilia.edu";
            if (desktopPassword) desktopPassword.value = "password123";
            
            // Ensure scroll container is properly sized
            if (window.innerWidth <= 768) {
                const mobileContainer = document.querySelector('.mobile-container');
                if (mobileContainer) {
                    mobileContainer.style.minHeight = '100vh';
                    mobileContainer.style.height = 'auto';
                }
            }
        });
    </script>
</body>
</html>